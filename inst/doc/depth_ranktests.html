<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Joris Chau" />

<meta name="date" content="2018-10-06" />

<title>Data depth and rank-based tests for HPD matrices</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Data depth and rank-based tests for HPD matrices</h1>
<h4 class="author"><em>Joris Chau</em></h4>
<h4 class="date"><em>2018-10-06</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#data-depth-of-hpd-matrices-with-pddepth">Data depth of HPD matrices with <code>pdDepth()</code></a></li>
<li><a href="#rank-based-tests-for-hpd-matrices-with-pdranktests">Rank-based tests for HPD matrices with <code>pdRankTests()</code></a></li>
<li><a href="#demo-r-shiny-app">Demo R-Shiny app</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Nondegenerate covariance, correlation and spectral density matrices are necessarily sym- metric or Hermitian and positive definite. In <span class="citation">(Chau, Ombao, and Sachs 2017)</span>, we develop statistical data depths for collections of Hermitian positive definite matrices by exploiting the geometric structure of the space as a Riemannian manifold. Data depth is an important tool in statistical data analysis measuring the <em>depth</em> of a point with respect to a data cloud or probability distribution. In this way, data depth provides a center-to-outward ordering of multivariate data observations, generalizing the notion of a rank for univariate observations.</p>
<p>The proposed data depth measures can be used to characterize most central regions or detect outlying observations in samples of HPD matrices, such as collections of covariance or spectral density matrices. The depth functions also provide a practical framework to perform rank-based hypothesis testing for samples of HPD matrices by replacing the usual ranks by their depth-induced counterparts. Other applications of data depth include the construction of confidence regions, clustering, or classification for samples of HPD matrices.</p>
<p>In this vignette we demonstrate the use of the functions <code>pdDepth()</code> and <code>pdRankTests()</code> to compute data depth values of HPD matrix-valued observations and perform rank-based hypothesis testing for samples of HPD matrices, where the space of HPD matrices can be equipped with several different metrics, such as the affine-invariant Riemannian metric as discussed in <span class="citation">(Chau, Ombao, and Sachs 2017)</span> or Chapter 4 of <span class="citation">(Chau 2018)</span>.</p>
</div>
<div id="data-depth-of-hpd-matrices-with-pddepth" class="section level2">
<h2>Data depth of HPD matrices with <code>pdDepth()</code></h2>
<p>First, we generate a pointwise random sample of <code>(2,2)</code>-dimensional HPD matrix-valued observations using the exponential map <code>Expm()</code>, with underlying intrinsic (i.e., Karcher or Fréchet) mean equal to the identity matrix <code>diag(2)</code>. Second, we generate a random sample of sequences (discretized curves) of <code>(2,2)</code>-dimensional HPD matrix-valued observations, with underlying intrinsic mean curve equal to an array of rescaled identity matrices. For instance, we can think of the first sample as a random collection of HPD covariance matrices, and the second sample as a random collection of HPD spectral matrix curves in the frequency domain.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">## Pointwise random sample</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(pdSpecEst); <span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">X1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T))); <span class="kw">str</span>(X1)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;  cplx [1:2, 1:2, 1:50] 0.7794+0i -0.0314-0.0523i -0.0314+0.0523i ...</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">## Curve random sample</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">X2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="fl">0.5</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">                           </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T) <span class="op">/</span><span class="st"> </span>i), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>)); <span class="kw">str</span>(X2)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  cplx [1:2, 1:2, 1:5, 1:50] 1.074+0i 0.352+0.147i 0.352-0.147i ...</span></a></code></pre></div>
<p>The function <code>H.coeff()</code> expands an Hermitian matrix with respect to an orthonormal basis of the space of Hermitian matrices equipped with the Frobenius (Euclidean) inner product <span class="math inline">\(\langle .,. \rangle_F\)</span>. By specifying the argument <code>inverse = T</code>, the function computes an inverse basis expansion, transforming a real-valued basis component vector back to an Hermitian matrix.</p>
<p>The function <code>pdDepth()</code> computes the intrinsic data depth of a single HPD matrix (resp. curve of HPD matrices) <code>y</code> with respect to a sample of HPD matrices (resp. sample of curves of HPD matrices) <code>X</code>. The intrinsic data depth is calculated in the space of HPD matrices equipped with one of the following metrics: (i) affine-invariant Riemannian metric (<code>metric = &quot;Riemannian&quot;</code>), (ii) log-Euclidean metric, the Euclidean inner product between matrix logarithms (<code>metric = &quot;logEuclidean&quot;</code>), (iii) Cholesky metric, the Euclidean inner product between Cholesky decompositions (<code>metric = &quot;Cholesky&quot;</code>), (iv) Euclidean metric (<code>metric = &quot;Euclidean&quot;</code>) and (v) root-Euclidean metric, the Euclidean inner product between Hermitian square root matrices (<code>metric = &quot;rootEuclidean&quot;</code>). Note that the default choice (affine-invariant Riemannian) has several useful properties not shared by the other metrics. See <span class="citation">(Chau, Ombao, and Sachs 2017)</span> and Chapter 4 of <span class="citation">(Chau 2018)</span> for more details and additional properties of the available intrinsic depth functions.</p>
<p><strong>Remark</strong>: an advantage of substituting, for instance, the Log-Euclidean metric is that the depth computation times may be significantly faster, in particular for large sample sizes. However, the data depths with respect to the Log-Euclidean metric are not <em>general linear congruence invariant</em> according to Chapter 4 of <span class="citation">(Chau 2018)</span>, and should therefore be used with caution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Pointwise geodesic distance, zonoid and spatial depth</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">point.depth &lt;-<span class="st"> </span><span class="cf">function</span>(method) <span class="kw">pdDepth</span>(<span class="dt">y =</span> <span class="kw">diag</span>(<span class="dv">2</span>), <span class="dt">X =</span> X1, <span class="dt">method =</span> method)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">point.depth</span>(<span class="st">&quot;gdd&quot;</span>); <span class="kw">point.depth</span>(<span class="st">&quot;zonoid&quot;</span>); <span class="kw">point.depth</span>(<span class="st">&quot;spatial&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; [1] 0.4326915</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [1] 0.7600822</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [1] 0.7932682</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">## Integrated geodesic distance, zonoid and spatial depth</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">int.depth &lt;-<span class="st"> </span><span class="cf">function</span>(method){ <span class="kw">pdDepth</span>(<span class="dt">y =</span> <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">                                    <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>), <span class="dt">X =</span> X2, <span class="dt">method =</span> method) }</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">int.depth</span>(<span class="st">&quot;gdd&quot;</span>); <span class="kw">int.depth</span>(<span class="st">&quot;zonoid&quot;</span>); <span class="kw">int.depth</span>(<span class="st">&quot;spatial&quot;</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [1] 0.751167</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [1] 0.8631369</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [1] 0.8825155</span></a></code></pre></div>
<p>By leaving the argument <code>y</code> in the function <code>pdDepth()</code> unspecified, the function computes the data depth of each individual object in the sample array <code>X</code> with respect to the sample <code>X</code> itself.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">(dd1 &lt;-<span class="st"> </span><span class="kw">pdDepth</span>(<span class="dt">X =</span> X1, <span class="dt">method =</span> <span class="st">&quot;gdd&quot;</span>)) <span class="co">## pointwise geodesic distance depth</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;  [1] 0.4136872 0.4072360 0.4025387 0.4044413 0.2559378 0.3873209 0.3832640</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;  [8] 0.3002407 0.4034977 0.3358114 0.2597040 0.3120139 0.1967228 0.1876342</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; [15] 0.1922631 0.2483946 0.3696490 0.3386755 0.2068996 0.2058298 0.2020919</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; [22] 0.3757002 0.2523476 0.2142259 0.2864097 0.3353675 0.3192103 0.3354539</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; [29] 0.3210167 0.3004936 0.3990564 0.3107404 0.3665464 0.2987992 0.4306943</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; [36] 0.2448184 0.3170413 0.2921210 0.4100427 0.4292756 0.4257262 0.3645616</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; [43] 0.3668837 0.2471900 0.2340217 0.3391741 0.3632063 0.3623502 0.2293419</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; [50] 0.2719987</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">(dd2 &lt;-<span class="st"> </span><span class="kw">pdDepth</span>(<span class="dt">X =</span> X2, <span class="dt">method =</span> <span class="st">&quot;gdd&quot;</span>)) <span class="co">## integrated geodesic distance depth</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  [1] 0.7001805 0.6885243 0.5746611 0.7066090 0.6931021 0.6423633 0.6738678</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  [8] 0.6197673 0.5654389 0.7123940 0.6469901 0.7158848 0.6487223 0.6243373</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; [15] 0.7075508 0.6356606 0.6654029 0.7162644 0.6380360 0.7091247 0.6595957</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; [22] 0.6520224 0.6627836 0.6932087 0.6783008 0.6798760 0.6490358 0.7024616</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; [29] 0.6324775 0.6889687 0.6728189 0.6927310 0.6464986 0.6492694 0.6591718</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; [36] 0.6874394 0.6743475 0.6365783 0.6644634 0.7112869 0.6935939 0.7361826</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; [43] 0.7209363 0.6161036 0.6952725 0.6470956 0.6250286 0.7059682 0.7125312</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; [50] 0.7113942</span></a></code></pre></div>
<p>A center-to-outward ordering of the individual objects in the sample of (curves of) HPD matrices is then obtained by computing the data depth induced ranks, with the most central observation (i.e., highest depth value) having smallest rank and the most outlying observation (i.e., lowest depth value) having largest rank.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">(dd1.ranks &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>dd1)) <span class="co">## pointwise depth ranks</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;  [1]  4  6  9  7 37 11 12 31  8 22 36 28 48 50 49 39 14 21 45 46 47 13 38</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; [24] 44 34 24 26 23 25 30 10 29 16 32  1 41 27 33  5  2  3 17 15 40 42 20</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [47] 18 19 43 35</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">(dd2.ranks &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>dd2)) <span class="co">## integrated depth ranks</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  [1] 14 21 49 11 18 40 26 47 50  6 38  4 36 46 10 43 28  3 41  9 31 33 30</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [24] 17 24 23 35 13 44 20 27 19 39 34 32 22 25 42 29  8 16  1  2 48 15 37</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; [47] 45 12  5  7</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">## Explore sample X1</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="kw">head</span>(<span class="kw">order</span>(dd1.ranks)) <span class="co">## most central observations</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [1] 35 40 41  1 39  2</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="kw">rev</span>(<span class="kw">tail</span>(<span class="kw">order</span>(dd1.ranks))) <span class="co">## most outlying observations</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; [1] 14 15 13 21 20 19</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">X1[ , , <span class="kw">which</span>(dd1.ranks <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)] <span class="co">## most central HPD matrix</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;                       [,1]                  [,2]</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; [1,]  0.9407902+0.0000000i -0.0154483+0.1752587i</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; [2,] -0.0154483-0.1752587i  1.2710700+0.0000000i</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">X1[ , , <span class="kw">which</span>(dd1.ranks <span class="op">==</span><span class="st"> </span><span class="dv">50</span>)] <span class="co">## most outlying HPD matrix</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;                     [,1]                [,2]</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; [1,]  1.847918+0.000000i -1.288255+1.075924i</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; [2,] -1.288255-1.075924i  2.490724+0.000000i</span></a></code></pre></div>
<p>We can compare the most central HPD matrix above with the intrinsic median of the observations under the affine-invariant metric obtained with <code>pdMedian()</code>. Note that the intrinsic sample median maximizes the geodesic distance depth in a given sample of HPD matrices. The point of maximum depth (i.e., deepest point) with respect to the intrinsic zonoid depth is the intrinsic sample mean, which can be obtained with <code>pdMean()</code>. For more details, see <span class="citation">(Chau, Ombao, and Sachs 2017)</span> or Chapter 4 of <span class="citation">(Chau 2018)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">(med.X1 &lt;-<span class="st"> </span><span class="kw">pdMedian</span>(X1)) <span class="co">## intrinsic sample median</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;                         [,1]                    [,2]</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [1,]  0.90753401+0.00000000i -0.03426934+0.03226425i</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [2,] -0.03426934-0.03226425i  1.15446038-0.00000000i</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">pdDepth</span>(<span class="dt">y =</span> med.X1, <span class="dt">X =</span> X1, <span class="dt">method =</span> <span class="st">&quot;gdd&quot;</span>) <span class="co">## maximum out-of-sample depth</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] 0.4409941</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">max</span>(dd1) <span class="co">## maximum in-sample depth</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; [1] 0.4306943</span></a></code></pre></div>
</div>
<div id="rank-based-tests-for-hpd-matrices-with-pdranktests" class="section level2">
<h2>Rank-based tests for HPD matrices with <code>pdRankTests()</code></h2>
<p>The null hypotheses of the available rank-based hypothesis tests in the function <code>pdRankTests()</code> are specified by the argument <code>test</code> and can be one of the following:</p>
<ul>
<li><code>&quot;rank.sum&quot;</code>: homogeneity of distributions of two independent samples of HPD matrices (resp. sequences of HPD matrices).</li>
<li><code>&quot;krusk.wall&quot;</code>: homogeneity of distributions of more than two independent samples of HPD matrices (resp. sequences of HPD matrices).</li>
<li><code>&quot;signed-rank&quot;</code>: homogeneity of distributions of independent paired or matched samples of HPD matrices.</li>
<li><code>&quot;bartels&quot;</code>: exchangeability (i.e. randomness) within a single independent sample of HPD matrices (resp. sequences of HPD matrices).</li>
</ul>
<p>Below, we construct several simulated examples for which: (i) the null hypotheses listed above are satisfied; and (ii) the null hypotheses listed above are not satisfied. Analogous to the previous section, we generate pointwise random samples (resp. random samples of sequences) of <code>(2,2)</code>-dimensional HPD matrix-valued observations, with underlying geometric mean equal to the identity matrix (resp. sequence of scaled identity matrices).</p>
<p>Let us first consider simulated examples of the intrinsic Wilcoxon rank-sum test (<code>test = &quot;rank.sum&quot;</code>) and intrinsic Kruskal-Wallis test (<code>test = &quot;krusk.wall&quot;</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">## Generate data (null true)</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">data1 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(X1, <span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T)))), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)) <span class="co">## pointwise HPD sample</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">data2 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(X2, <span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T) <span class="op">/</span><span class="st"> </span>i), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>))), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">100</span>)) <span class="co">## HPD curve sample</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">## Generate data (null false)</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">data1a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(X1, <span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T)))), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)) <span class="co">## pointwise HPD scale change</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">data2a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(X2, <span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T) <span class="op">/</span><span class="st"> </span>i), <span class="dt">simplify =</span> <span class="st">&quot;arra&quot;</span>))), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">100</span>)) <span class="co">## HPD curve scale change</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">## Rank-sum test</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw">pdRankTests</span>(data1, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>), <span class="st">&quot;rank.sum&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co">## null true (pointwise)</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; $test</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [1] &quot;Intrinsic Wilcoxon rank-sum&quot;</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; [1] 0.1037495</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; $statistic</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; [1] 1.626941</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; $null.distr</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; [1] &quot;Standard normal distribution&quot;</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="kw">pdRankTests</span>(data2, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>), <span class="st">&quot;rank.sum&quot;</span>)[<span class="dv">2</span>] <span class="co">## null true (curve)</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; [1] 0.9834998</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="kw">pdRankTests</span>(data1a, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>), <span class="st">&quot;rank.sum&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (pointwise)</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; [1] 6.958285e-11</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="kw">pdRankTests</span>(data2a, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>), <span class="st">&quot;rank.sum&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (curve)</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; [1] 1.020181e-15</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">## Kruskal-Wallis test</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="kw">pdRankTests</span>(data1, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">25</span>), <span class="st">&quot;krusk.wall&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co">## null true (pointwise)</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; $test</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; [1] &quot;Intrinsic Kruskal-Wallis&quot;</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; [1] 0.1443239</span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt; $statistic</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; [1] 3.87139</span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; $null.distr</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; [1] &quot;Chi-squared distribution (df = 2)&quot;</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="kw">pdRankTests</span>(data2, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">25</span>), <span class="st">&quot;krusk.wall&quot;</span>)[<span class="dv">2</span>] <span class="co">## null true (curve)</span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; [1] 0.1526552</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="kw">pdRankTests</span>(data1a, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">25</span>), <span class="st">&quot;krusk.wall&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (pointwise)</span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; [1] 5.495634e-10</span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="kw">pdRankTests</span>(data2a, <span class="dt">sample_sizes =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">25</span>), <span class="st">&quot;krusk.wall&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (curve)</span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="co">#&gt; [1] 1.033775e-14</span></a></code></pre></div>
<p>To apply the manifold Wilcoxon signed-rank test (<code>test = &quot;signed-rank&quot;</code>), we generate paired observations for independent trials (or subjects) by introducing trial-specific random effects, such that the paired observations in each trial share a trial-specific geometric mean. Note that for such data the intrinsic Wilcoxon rank-sum test is no longer valid due to the introduced sample dependence.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">## Trial-specific means</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">mu &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">50</span>, <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T)))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">## Generate paired samples X,Y</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">make_sample &lt;-<span class="st"> </span><span class="cf">function</span>(null) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(mu[, , i], pdSpecEst<span class="op">:::</span><span class="kw">T_coeff_inv</span>(<span class="kw">ifelse</span>(null, <span class="dv">1</span>, <span class="fl">0.5</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rexp</span>(<span class="dv">4</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, mu[, , i])), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">X3 &lt;-<span class="st"> </span><span class="kw">make_sample</span>(<span class="dt">null =</span> T) <span class="co">## refernce sample </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">Y3 &lt;-<span class="st"> </span><span class="kw">make_sample</span>(<span class="dt">null =</span> T) <span class="co">## null true</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">Y3a &lt;-<span class="st"> </span><span class="kw">make_sample</span>(<span class="dt">null =</span> F) <span class="co">## null false (scale change)</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">## Signed-rank test</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="kw">pdRankTests</span>(<span class="kw">array</span>(<span class="kw">c</span>(X3, Y3), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)), <span class="dt">test =</span> <span class="st">&quot;signed.rank&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co">## null true</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; $test</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [1] &quot;Intrinsic Wilcoxon signed-rank&quot;</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; [1] 0.2025809</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; $statistic</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;   V </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; 505 </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; $null.distr</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [1] &quot;Wilcoxon signed rank test with continuity correction&quot;</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="kw">pdRankTests</span>(<span class="kw">array</span>(<span class="kw">c</span>(X3, Y3a), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)), <span class="dt">test =</span> <span class="st">&quot;signed.rank&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; [1] 0.001444632</span></a></code></pre></div>
<p>The intrinsic signed-rank test also provides a valid procedure to test for equivalence of spectral matrices of two (independent) multivariate stationary time series based on the HPD periodogram matrices obtained via <code>pdPgram()</code>. In contrast to other available tests in the literature, this asymptotic test does not require consistent spectral estimators or resampling of test statistics, and therefore remains computationally efficient for higher-dimensional spectral matrices or a large number of sampled Fourier frequencies.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">## Signed-rank test for equivalence of spectra</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">## vARMA(1,1) process: Example 11.4.1 in (Brockwell and Davis, 1991)</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">Phi &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">Theta &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.71</span>, <span class="fl">0.71</span>, <span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">pgram &lt;-<span class="st"> </span><span class="cf">function</span>(Sigma) <span class="kw">pdPgram</span>(<span class="kw">rARMA</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">10</span>, <span class="dv">2</span>, Phi, Theta, Sigma)<span class="op">$</span>X)<span class="op">$</span>P <span class="co">## HPD periodogram</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">## Null is true</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="kw">pdRankTests</span>(<span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">pgram</span>(Sigma), <span class="kw">pgram</span>(Sigma)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span><span class="op">^</span><span class="dv">10</span>)), <span class="dt">test =</span> <span class="st">&quot;signed.rank&quot;</span>)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; [1] 0.4047506</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">## Null is false</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="kw">pdRankTests</span>(<span class="kw">array</span>(<span class="kw">c</span>(<span class="kw">pgram</span>(Sigma), <span class="kw">pgram</span>(<span class="fl">0.9</span> <span class="op">*</span><span class="st"> </span>Sigma)), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span><span class="op">^</span><span class="dv">10</span>)), <span class="dt">test =</span> <span class="st">&quot;signed.rank&quot;</span>)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; [1] 0.003768685</span></a></code></pre></div>
<p>To conclude, we demonstrate the intrinsic Bartels-von Neumman test (<code>test = &quot;bartels&quot;</code>) by generating an independent non-identically distributed sample of HPD matrices with a trend in the scale of the distribution across observations. In this case, the null hypothesis of randomness breaks down.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">## Null is true</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">data3 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">200</span>, <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T))) <span class="co">## iid HPd sample</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">data4 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(<span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T) <span class="op">/</span><span class="st"> </span>i), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>)) <span class="co">## iid HPD curve</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">## Null is false</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">data3a &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>, <span class="cf">function</span>(j) <span class="kw">Expm</span>(<span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(((<span class="dv">200</span> <span class="op">-</span><span class="st"> </span>j) <span class="op">/</span><span class="st"> </span><span class="dv">200</span> <span class="op">+</span><span class="st"> </span>j <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">200</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T)), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>) <span class="co">## pointwise trend in scale</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">data4a &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="cf">function</span>(j) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(i) <span class="kw">Expm</span>(i <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="kw">H.coeff</span>(((<span class="dv">100</span> <span class="op">-</span><span class="st"> </span>j) <span class="op">/</span><span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span>j <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">inverse =</span> T) <span class="op">/</span><span class="st"> </span>i), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>) <span class="co">## curve trend in scale</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">## Bartels-von Neumann test</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw">pdRankTests</span>(data3, <span class="dt">test =</span> <span class="st">&quot;bartels&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co">## null true (pointwise)</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; $test</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; [1] &quot;Intrinsic Bartels-von Neumann&quot;</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; [1] 0.2641266</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; $statistic</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; [1] 1.116691</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; $null.distr</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; [1] &quot;Standard normal distribution&quot;</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="kw">pdRankTests</span>(data4, <span class="dt">test =</span> <span class="st">&quot;bartels&quot;</span>)[<span class="dv">2</span>] <span class="co">## null true (curve)</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; [1] 0.7612759</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="kw">pdRankTests</span>(data3a, <span class="dt">test =</span> <span class="st">&quot;bartels&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (pointwise)</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; [1] 1.612058e-05</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="kw">pdRankTests</span>(data4a, <span class="dt">test =</span> <span class="st">&quot;bartels&quot;</span>)[<span class="dv">2</span>] <span class="co">## null false (curve)</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; $p.value</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; [1] 0.000732231</span></a></code></pre></div>
</div>
<div id="demo-r-shiny-app" class="section level2">
<h2>Demo R-Shiny app</h2>
<p>A demo R-Shiny app to calculate the intrinsic data depth and perform rank-based hypothesis tests for samples in the space of HPD matrices is available <a href="https://jchau.shinyapps.io/pdSpecEst_app/">here</a>. The app allows the user to examine the performance of the different depth rank-based tests based on simulated samples of HPD matrices.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-C18">
<p>Chau, J. 2018. “Advances in Spectral Analysis for Multivariate, Nonstationary and Replicated Time Series.” PhD thesis, Universite catholique de Louvain.</p>
</div>
<div id="ref-COvS17">
<p>Chau, J., H. Ombao, and R. von Sachs. 2017. “Intrinsic Data Depth for Hermitian Positive Definite Matrices.” <em>ArXiv Preprint 1706.08289</em>. <a href="https://arxiv.org/abs/1706.08289" class="uri">https://arxiv.org/abs/1706.08289</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
